-----
### Vary 헤더
-----
1. 브라우저와 서버로부터 온 전형적인 요청과 응답 헤더의 예
<div align="center">
<img src="https://github.com/user-attachments/assets/a273bc6a-3920-4504-abb8-7f52f2fb00f6">
</div>

2. 만약 서버의 판단이 User-Agent와 같은 Accept 이외의 다른 헤더에 기초한 것일 경우
   - 만약 서버가 어떤 페이지를 반환할 것인지 판단하기 위해, 다른 헤더들을 사용하고 있다면, 캐시는 반드시 그 헤더들이 무엇인지 알아야 하고 캐시된 페이지 중 어떤 것을 반환할지 선택할 때, 서버가 했던 것과 같은 논리를 적용해야 함
  
3. HTTP Vary 응답 헤더는 서버가 문서를 선택하거나 커스텀 콘텐츠를 생성할 때 고려한 클라이언트 요청 헤더 모두(일반적인 내용 협상 헤더 외 추가로 더해서)를 나열
   - 예를 들어, 제공된 문서가 User-Agent 헤더에 의존한다면, Vary 헤더는 반드시 User-Agent를 포함해야 함

4. 새 요청이 도착했을 때, 캐시는 내용 협상 헤더들을 이용해 가장 잘 맞는 것을 찾음
   - 그러나 캐시가 문서를 클라이언트에게 제공해 줄 수 있게 되기 전에, 캐시는 반드시 캐시된 응답 안에 서버가 보낸 Vary 헤더가 들어있는지 확인해야 함
   - 만약 Vary 헤더가 존재한다면, 그 Vary 헤더가 명시하고 있는 헤더들은 새 요청과 오래된 캐시된 요청에서 그 값이 서로 맞아야함
   - 서버는 클라이언트의 요청 헤더에 따라 그들의 응답이 달라질 수 있으므로, 투명 협상을 구현하기 위해 캐시는 반드시 캐시된 배리언트(Variant)와 함께 클라이언트 요청 헤더와 그에 알맞은 서버 응답 헤더 양쪽 모두 저장해야 함
<div align="center">
<img src="https://github.com/user-attachments/assets/1ac8a7e6-cd72-473d-a4c1-ec97d12acb2c">
</div>

5. 만약 서버의 Vary 헤더가 다음과 같다면, 거대한 수의 다른 User-Agent와 Cookie 값이 많은 배리언트를 생성
<div align="center">
<img src="https://github.com/user-attachments/assets/ee11ea42-9395-4d4e-aba8-f545b178247f">
</div>

   - 캐시는 각 배리언트마다 알맞은 문서 버전을 저장해야 함
   - 캐시가 검색을 할 때, 먼저 내용 협상 헤더로 적절한 콘텐츠를 맞춰보고, 다음에 요청의 배리언트를 캐시된 배리언트와 맞춰봄
   - 만약 맞는 것이 없으면, 캐시는 문서를 서버에서 가져옴
