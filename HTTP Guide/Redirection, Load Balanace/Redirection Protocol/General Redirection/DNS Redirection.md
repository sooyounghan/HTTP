-----
### DNS 리다이렉션
-----
1. 클라이언트가 죠의 하드웨어 웹 사이트에 접근하려고 시도할 때마다, 도메인 이름 ```www.joes-hardware.com```은 반드시 아이피 주소로 분석되어야 함
   - DNS 분석자는 클라이언트의 운영체제일 수도 있고, 클라이언트 네트워크에 있는 DNS 서버이거나 혹은 더 원격에 있는 DNS 서버일 수 있음
   - DNS는 하나의 도메인에 여러 아이피 주소가 결부되는 것을 허용하며, DNS 분석자는 여러 아이피 주소를 반환하도록 설정되거나 프로그래밍 될 수 있음
   - 분석자가 어떤 아이피 주소를 반환할 것인가 결정하는 방법은 단순한 것(라운드 로빈)부터 복잡한 것(여러 서버의 로드를 검사해서 로드가 가장 적은 서버의 아이피 주소를 반환하는 것)까지 다양

2. 예시) DNS 기반 리다이렉션
<div align="center">
<img src="https://github.com/user-attachments/assets/6eb09126-f9b2-4a3b-995c-aaa496997077">
</div>

   - 죠는 ```www.joes-hardware.com```을 위해 4대의 서버 운용
   - DNS 서버는 ```www.joes-hardware.com```에 대해 4개의 아이피 주소 중 어떤 것을 돌려줄 지 결정해야 함
   - 가장 쉬운 DNS 알고리즘은 단순한 라운드 로빈

3. DNS 라운드 로빈 : 가장 흔한 동시에 가장 단순한 리다이렉션 기법
   - DNS 라운드 로빈은 웹 서버 팜 전체에 부하 균형을 유지하기 위해 DNS 호스트 명 분석 기능을 사용 (순수한 부하 균형 전략이며, 서버에 대한 클라이언트의 상대적 위치나 서버의 현재 스트레스를 고려하지 않음)
   - 예) ```CNN.com```의 동작 방식
<div align="center">
<img src="https://github.com/user-attachments/assets/017fab5c-40a9-4f14-9626-6fe9edfea582">
</div>

   - ```www.cnn.com``` 웹 사이트는 실제로 20개의 구분된 아이피 주소 농장(IP Farm)
   - 각 아이피 주소는 일반적 경우라면 각각 다른 물리적 서버로 해석되었을 것

4. 다중 주소와 라운드 로빈 주소 순환
   - 대부분 DNS 클라이언트는 다중 주소 집합의 첫 번째 주소 사용
   - 부하 균형을 위해, 대부분 DNS 서버는 룩업이 끝났을 때마다 주소를 순환시키는데, 이 주소 순한을 DNS 라운드 로빈
   - 예) ```www.cnn.com```에 대해 세 번 연속으로 DNS 룩업을 하면 IP 주소들의 목록을 세 번 순환한 결과를 얻게 됨
<div align="center">
<img src="https://github.com/user-attachments/assets/7b23a9e2-3e89-4dd3-9939-2af14de34b17">
</div>

   - 첫 번째 DNS 룩업의 첫 번째 주소 : ```207.25.71.5```
   - 두 번째 DNS 룩업의 첫 번째 주소 : ```207.25.71.6```
   - 세 번째 DNS 룩업의 첫 번째 주소 : ```207.25.71.7```

5. 부하 균형을 위한 DNS 라운드 로빈
   - 대부분 DNS 클라이언트는 첫 번쨰 주소를 사용하므로, DNS 순환은 서버들 간 부하 균형을 유지
   - 만약, DNS가 주소를 순환시키지 않는다면, 대부분의 클라이언트 목록의 첫 번째 서버를 선택할 것이고, 그 서버가 대부분 부하를 받게 될 것
   - 부하 균형을 유지하기 위한 DNS 라운드 로빈 순환 동작 방식
<div align="center">
<img src="https://github.com/user-attachments/assets/cba9051b-ebf4-4b4f-8362-eb2fdc72fb73">
</div>

   - 앨리스가 ```www.cnn.com```에 접속하려고 시도할 때, DNS를 이용해 IP 주소를 찾아보고 ```207.25.71.5```를 첫 번째 아이피 주소로 돌려 받으며, 20-3c와 같은 웹 서버 ```207.25.71.5```에 접속
   - 계속해서 밥이 ```www.cnn.com```에 접속하려고 시도할 때, 그 또한 DNS를 이용해 IP 주소를 찾아보는데, 이 때 다른 결과를 얻게 됨 : 앨리스의 이전 요청에 의해 주소 목록이 한 차례 순환되었기 때문임
     + 밥은 ```207.25.71.6```을 첫 번째 아이피 주소로 돌려받고, 그림 20-3f와 같이 이 서버에 접속

6. DNS 캐싱의 효과
   - DNS 주소 순환은 부하를 순환시킴 : 서버에 대한 각 DNS 룩업은 서버 주소를 다른 순서로 가져오기 때문임
   - 그러나 이 부하 균형은 완벽하지 않음 : DNS 룩업의 결과는 애플리케이션, 운영체제, 몇 기초적인 DNS 서버에 의해 기억되어 재사용될 수 있기 때문임
   - 호스트 하나에 대해 한 번의 DNS 룩업을 수행한 뒤, 그 주소를 몇 번이고 다시 사용하면, DNS 룩업의 비용을 줄일 수 있을 뿐 아니라, 같은 클라이언트와 계속 대화하는 것을 선호하는 서버들도 있기 때문에, DNS 라운드 로빈은 일반적으로 하나의 클라이언트로 인한 부하를 제대로 분산하지 못함
   - 그러나 DNS가 단일 클라이언트 트랜잭션을 서버의 복제들에게 나눠주지 않더라도, 여러 클라이언트들의 부하 총량을 분산하는 적절한 작업을 수행
   - 비슷한 요청을 하는 클라이언트 수가 어느 정도 이상만 되면, 부하는 모든 서버에 걸쳐 상대적으로 잘 분산 될 것

7. 다른 DNS 기반 리다이렉션 알고리즘 : 향상된 DNS 서버는 주소의 순서를 결정하기 위해 다른 기법 사용
   - 부하 균형 알고리즘 : 몇몇 DNS 서버는 웹 서버 로드를 추적하고 가장 로드가 적은 웹 서버를 목록의 가장 위에 올려놓음
   - 근접 라우팅 알고리즘 : 웹 서버들의 팜이 지리적으로 분산되어 있는 경우, DNS 서버는 사용자의 근처의 웹 서버로 보내는 시도를 할 수 있음
   - 결함 마스킹 알고리즘 : DNS 서버는 네트워크 건강 상태를 모니터링하고 요청을 정전이나 기타 장애를 피해서 라우팅할 수 있음
  
8. 일반적으로, 복잡한 서버 추적 알고리즘을 실행하고 있는 DNS 서버는 콘텐츠 제공자의 통제하에 있는 권위 있는 서버 (Authoritative Server)
<div align="center">
<img src="https://github.com/user-attachments/assets/faf6b670-6fd0-410e-93be-72b76a32ac1a">
</div>

   - 여러 분산 호스팅 서버들이 이 DNS 리다이렉션 모델을 이용
   - 인접한 서버를 찾는 서비스들을 위한 이 모델의 단점 : 권위 있는 DNS 서버가 결정을 내리기 위해 사용하는 유일한 정보가 클라이언트 아이피 주소가 아닌 로컬 DNS 서버 아이피 주소
