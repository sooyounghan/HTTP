-----
### 프록시 계층
-----
1. 프록시들은 프록시 계층이라고 불리는 연쇄를 구성할 수 있음
2. 프록시 계층에서 메세지는 최종적으로 원 서버에 도착할 때까지 프록시와 프록시를 거쳐 이동 (그 후 프록시들을 거쳐 다시 클라이언트로 돌아옴)
3. 프록시 계층에서 프록시 서버들은 부모와 자식 관계를 가짐
<div align="center">
<img src="https://github.com/user-attachments/assets/8e9195ad-8a76-4c76-80c4-385fcec22b81">
</div>

   - 다음 번 인바운드 프록시(서버에서 가까운 쪽)을 부모라고 부름
   - 다음 번 아웃바운드 프록시(클라이언트에서 가까운 쪽)을 자식이라 부름
   - 따라서, 프록시 2는 프록시 3의 자식 프록시이며, 프록시 3은 프록시 2의 부모 프록시

4. 프록시 계층 콘텐츠 라우팅
<div align="center">
<img src="https://github.com/user-attachments/assets/8e9195ad-8a76-4c76-80c4-385fcec22b81">
</div>

   - 프록시 계층은 정적이며, 프록시 1은 언제나 메세지를 프록시 2로 봬고, 프록시 2는 언제나 메세지를 프록시 3으로 보냄
   - 그러나 계층이 반드시 정적이어야 하는 것은 아니며, 프록시 서버는 여러 가지 판단 근거에 의해 메세지를 다양하고 유동적인 프록시 서버와 원 서버들의 집합에게 보낼 수 있음
   - 접근 프록시는 상황에 맞게 프록시나 원 서버에게 라우팅 가능
<div align="center">
<img src="https://github.com/user-attachments/assets/5be37ab4-795a-4350-87ea-f19c428e54e5">
</div>

   - 요청된 객체가 콘텐츠 분산을 위한 웹 서버에 속한 경우, 프록시는 요청을 가까운 캐시 서버에게 보내 캐시된 객체를 반환하거나 그럴 수 없을 때는 서버에서 가져오게 할 수 있음
   - 요청이 특정 종류의 이미지에 대한 것인 경우, 접근 프록시는 그 요청을 특화된 압축 프록시에게 보내어 그 프록시가 이미지를 가져와 압축하게 하여 느린 모뎀으로 접속했더라도 빠르게 클라이언트가 다운로드할 수 있게 함

5. 동적 부모의 선택의 예
   - 부하 균형 : 자식 프록시는 부하를 분산하기 위해 현재 부모들의 작업량 수준에 근거해 부모 프록시를 고름
   - 지리적 인접성에 근거한 라우팅 : 자식 프록시는 원 서버의 지역을 담당하는 부모를 선택할 수 있음
   - 프로토콜 / 타입 라우팅 : 어떤 자식 프록시는 URI에 근거해 다른 부모나 원 서버에 라우팅 가능, 어떤 특정 종류의 URI를 갖고 있는 경우, 특별한 프록시 서버로 보내져 특별한 프로토콜로 처리 가능
   - 유료 서비스 가입자를 위한 라우팅 : 빠른 서비스를 위해 요금을 지불했다면, 그들의 URI는 대형 캐시나 성능 개선을 위한 압축 엔진으로 라우팅 가능

6. 프록시의 트래픽 처리
<div align="center">
<img src="https://github.com/user-attachments/assets/5f432fb8-8032-4a84-b61c-5c9ce7749b2c">
</div>

   - 클라이언트는 보통 웹 서버와 대화하므로, 클라이언트 트래픽이 프록시로 가도록 하는 방법
   - 클라이언트 수정 : 구글 크롬과 마이크로소프트 브라우저를 포함한 많은 웹 클라이언트들은 수동 혹은 자동 프록시 설정을 지원
     + 만약 클라이언트가 프록시를 사용하도록 설정되어 있다면, 클라이언틑는 HTTP 요청을 바로 그리고 의도적으로 원 서버가 아닌 프록시로 보냄 (6-14a)

   - 네트워크를 수정 : 클라이언트는 알지도 못하고 간섭도 할 수 없는 상태에서, 네트워크 인프라를 가로채서 웹 트래픽을 프록시로 가도록 조정하는 몇 가지 기법 존재
     + 이 가로챔은 일반적으로 HTTP 트래픽을 지켜보고 가로채어 클라이언트 모르게 트래픽을 프록시로 보내는 스위칭 장치와 라우팅 장치를 필요로 함 (6-14b)
     + 이를 인터셉트 프록시라고 부름 (투명 프록시(Transparent Proxy)라고도 부르며, 존재하는 것 조차 눈치채지 못하고 그들에게 연결하게 되기 때문임, 투명이라는 단어가 HTTP 명세에서 행위의 의미를 변경하지 않는다는 뜻으로 사용되므로, 표준 커뮤니티에서는 가로챔(Interception)이라는 단어를 사용할 것 권장)

   - DNS 이름공간 수정 : 웹 서버 앞에 위치하는 프록시 서버인 대리 프록시는 웹 서버의 이름과 IP 주소를 자신이 직접 사용
     + 모든 요청은 서버 대신 대리 프록시로 감 (6-14c)
     + 이는 DNS 이름 테이블을 수동으로 편집하거나 사용할 적절한 프록시나 서버를 계산해주는 특별한 동적 DNS 서버를 이용해 조정될 수 있음
     + 몇몇 설치본에서는, 실제 서버의 IP 주소와 이름은 변경되고 대리 프락시에게는 이전의 주소와 이름이 주어짐

   - 웹 서버를 수정 : 몇몇 웹 서버는 HTTP 리다이렉션 명령(응답 코드 305)을 클라이언트에게 돌려줌으로써 클라이언트의 요청을 프록시로 리다이렉트하도록 설정할 수 있음
     + 리다이렉트를 받는 즉시 클라이언트는 프록시와의 트랜잭션을 시작 (6-14)

